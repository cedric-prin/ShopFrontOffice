<VirtualHost *:80>
    DocumentRoot /var/www/html/public

    # Forcer les types MIME pour les fichiers statiques AVANT le Directory
    # Utiliser AddType au lieu de Header pour être plus fiable
    AddType text/css .css
    AddType application/javascript .js
    AddType image/jpeg .jpg .jpeg
    AddType image/png .png
    AddType image/svg+xml .svg
    AddType image/x-icon .ico
    AddType font/woff .woff
    AddType font/woff2 .woff2
    AddType application/font-ttf .ttf
    AddType application/vnd.ms-fontobject .eot

    <Directory /var/www/html/public>
        AllowOverride All
        Require all granted
        Options -Indexes +FollowSymLinks
        
        # Désactiver le rewriting pour les fichiers statiques au niveau Directory
        <FilesMatch "\.(css|js|jpg|jpeg|png|gif|svg|ico|woff|woff2|ttf|eot|map|pdf|zip|txt|json|xml)$">
            RewriteEngine Off
            # Forcer les types MIME même ici
            Header set Content-Type "text/css; charset=utf-8" "expr=%{REQUEST_URI} =~ m#\.css$#"
            Header set Content-Type "application/javascript; charset=utf-8" "expr=%{REQUEST_URI} =~ m#\.js$#"
        </FilesMatch>
    </Directory>

    # Désactiver le rewriting pour les fichiers statiques au niveau VirtualHost
    <LocationMatch "\.(css|js|jpg|jpeg|png|gif|svg|ico|woff|woff2|ttf|eot|map|pdf|zip|txt|json|xml)$">
        RewriteEngine Off
    </LocationMatch>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
